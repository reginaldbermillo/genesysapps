let sdx_web_survey_options={};window.SDXSurvey={showSurvey:function(e){if(!this.validateOptions(e))return!1;if(document.getElementById("sdx-survey-container"))return console.log("A survey already exists on this web page."),!1;e=this.formatOptions(e),sdx_web_survey_options=e;let t=this.generateSdxSurveyUrl(e),n=e.config;"new-tab"===n.location?this.showSurveyInNewTab(t):["bottom-left","top-right","bottom-right"].includes(n.location)?this.showSurveyInCorner(t,n.location,n.show_exit_button):this.showSurveyInHtmlElement(t,n.location)},formatOptions:function(e){return"survey_attributes"in e||(e.survey_attributes={}),"config"in e||(e.config={}),"location"in e.config||(e.config.location="bottom-right"),"skip_greeting"in e.config||(e.config.skip_greeting=!1),"show_exit_button"in e.config||(e.config.show_exit_button=!0),"destroy_survey_after_closing"in e.config||(e.config.destroy_survey_after_closing=!1),e},generateSdxSurveyUrl:function(e){let t=e.survey_url,n=e.survey_attributes;for(let e=0;e<Object.keys(n).length;e++)t=t.includes("?")?t+"&"+Object.keys(n)[e]+"="+Object.values(n)[e]:t+"?"+Object.keys(n)[e]+"="+Object.values(n)[e];return e.config.skip_greeting&&(t.includes("?")?t+="&_start=true":t+="?_start=true"),t},validateOptions:function(e){return void 0!==e&&"string"==typeof e.survey_url||(console.error("The Mindful Feedback web survey options must include a survey_url, as a string. "),!1)},showSurveyInNewTab:function(e){window.open(e,"_blank")},showSurveyInCorner:function(e,t,n){let o=this.getCornerSurveyHtml(e,t,n);document.body.appendChild(o)},showSurveyInHtmlElement:function(e,t){"#"===t.charAt(0)&&(t=t.substring(1));let n=document.createElement("iframe");n.style.cssText="all: unset;height:100%;width:100%;border:none;",n.id="sdx-survey-iframe",n.src=e;let o=document.getElementById(t);if(!o)return console.error("Could not locate element with ID "+t),!1;o.appendChild(n)},getCornerSurveyHtml:function(e,t,n){let o,i,s,r;"bottom-left"===t?(o="auto",i="20px",s="auto",r="20px"):"top-right"===t?(o="20px",i="auto",s="20px",r="auto"):(o="auto",i="20px",s="20px",r="auto");let d=document.createElement("div");d.id="sdx-survey-container";let u=document.createElement("iframe");if(u.id="sdx-survey-iframe",u.src=e,d.style.cssText="all: unset;transition:height 0.8s, width 0.8s;width:500px;max-height:600px;display: block;position:fixed; background-color:white; top:"+o+"; bottom:"+i+"; right:"+s+"; left:"+r+"; z-index:100000",u.style.cssText="all: unset;height:600px;border:none;width:500px;box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;",window.matchMedia("(max-width: 700px)").matches&&(d.style.width="100%",u.style.width="96%"),n){let e=document.createElement("div");e.innerHTML='<div id="sdx-toggle-survey-button" style="all: unset;background-color:white;font-size:14px;box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px;cursor:pointer;margin:14px 10px;border-radius:100px;position:fixed;top:'+o+"; bottom:"+i+"; right:"+s+"; left:"+r+'; z-index:1000000;display:flex;justify-content:center;align-items:center;padding:5px 15px;">Exit</div>',e.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',document.body.appendChild(e),e.addEventListener("click",this.toggleSurvey)}return d.appendChild(u),d},toggleSurvey:function(){if(sdx_web_survey_options.config.destroy_survey_after_closing)return SDXSurvey.closeSurvey(),!0;"none"===document.getElementById("sdx-survey-container").style.display?(document.getElementById("sdx-survey-container").style.display="",document.getElementById("sdx-toggle-survey-button").innerHTML="Exit",document.getElementById("sdx-survey-container").style.height="600px",window.matchMedia("(max-width: 700px)").matches?(document.getElementById("sdx-survey-container").style.width="100%",document.getElementById("sdx-survey-iframe").style.width="96%"):(document.getElementById("sdx-survey-container").style.width="500px",document.getElementById("sdx-survey-iframe").style.width="500px")):(document.getElementById("sdx-survey-container").style.height="0",document.getElementById("sdx-survey-container").style.width="0",setTimeout((function(){document.getElementById("sdx-survey-container").style.display="none",document.getElementById("sdx-toggle-survey-button").innerHTML="Open Survey"}),800))},closeSurvey:function(){document.getElementById("sdx-survey-container").remove(),document.getElementById("sdx-toggle-survey-button").remove()},surveyCompleted:function(e){window.addEventListener("message",(function(t){if(!t.origin.includes("surveydynamix.com")&&!t.origin.includes("survey-app.test"))return!1;"sdxSurveyCompleted"===t.data&&e()}))}};
